from selenium import webdriver
from selenium.webdriver.edge.options import Options
from selenium.webdriver.common.window import WindowTypes
import os
import time

# 1. User Home Directory ni Pondadam
user_home = os.path.expanduser("~")

# 2. Edge User Data Directory Path ni Set cheyyadam
edge_user_data_dir = os.path.join(user_home, "AppData", "Local", "Microsoft", "Edge", "User Data")

# 3. Edge Options ni Configure cheyyadam
edge_options = Options()
edge_options.add_argument(f"user-data-dir={edge_user_data_dir}")
edge_options.add_argument("profile-directory=Default")  # "Default" ni mi profile peru tho marchandi

# 4. Edge Browser ni Start cheyyadam
driver = webdriver.Edge(options=edge_options)

try:
    # 5. First URL ni Open cheyyadam
    driver.get("https://www.google.com")
    time.sleep(5)  # Page load ayyaka 5 seconds wait cheyyadam

    # 6. New Tab ni Create cheyyadam mariyu Switch cheyyadam
    driver.switch_to.new_window(WindowTypes.TAB)
    driver.get("https://www.geeksforgeeks.org")
    time.sleep(5)  # New tab load ayyaka 5 seconds wait cheyyadam

    # Ikkada kotha tab lo kavalsina actions ni perform cheyyandi

except Exception as e:
    print(f"An error occurred: {e}")

finally:
    # 7. Browser ni Close cheyyadam
    driver.quit()
