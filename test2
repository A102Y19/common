def unzip_PAK_file(file_name, source_path):
    if not file_name or not source_path or source_path.lower() == "nan":
        print("❌ Invalid input: file_name or source_path is missing.")
        return False

    zip_file_path = os.path.join(source_path, file_name)
    extract_path = source_path

    try:
        if os.path.exists(zip_file_path):
            with zipfile.ZipFile(zip_file_path, 'r') as zip_ref:
                zip_ref.extractall(extract_path)
            print(f"✅ Extracted '{file_name}' to {extract_path}")
            return True
        else:
            print(f"❌ ZIP file not found: {zip_file_path}")
            return False
    except Exception as e:
        print(f"❌ Error extracting file '{file_name}': {e}")
        return False




    elif action == "unzip pak file" and requirement == "Y" and input_value and input_value.lower() != "nan":
        if downloaded_file_name:
            unzip_PAK_file(downloaded_file_name, input_value)
        else:
            print("❌ No downloaded file available to unzip.")
