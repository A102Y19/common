from selenium import webdriver
from selenium.webdriver.edge.options import Options
import os
import time

# User home directory ni pondadam
user_home = os.path.expanduser("~")

# Edge user data directory path ni set cheyyadam
edge_user_data_dir = os.path.join(user_home, "AppData", "Local", "Microsoft", "Edge", "User Data")

# Edge options ni configure cheyyadam
edge_options = Options()
edge_options.add_argument(f"user-data-dir={edge_user_data_dir}")
edge_options.add_argument("profile-directory=Default")  # "Default" ni nee profile peru tho marchandi

# Edge browser ni start cheyyadam
driver = webdriver.Edge(options=edge_options)

# First URL ni open cheyyadam
driver.get("https://www.firsturl.com")
time.sleep(5)  # Page load ayyaka 5 seconds wait cheyyadam

# New tab create cheyyadam
driver.execute_script("window.open('https://www.secondurl.com', '_blank');")
time.sleep(5)  # New tab load ayyaka 5 seconds wait cheyyadam

# New tab ki switch cheyyadam
driver.switch_to.window(driver.window_handles[1])

# Ikkada nee original script lo unna actions ni perform cheyyandi

# Work ayyaka, browser ni close cheyyadam
driver.quit()
