import pandas as pd
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
import time

# Load Excel file
df = pd.read_excel("C:/PAK/PAK_Standard_requirement.xlsx")  # Change file name if needed

# Set up Chrome driver
options = webdriver.ChromeOptions()
options.add_experimental_option("detach", True)
driver = webdriver.Chrome(options=options)

def access_ftp(url):
    driver.get(url)
    time.sleep(2)  # Wait for page to load
    
    try:
        # Check if password field is present
        password_field = driver.find_element(By.NAME, "password")  # Change selector if needed
        password_field.send_keys("admin")  # Hardcoded password for now
        password_field.send_keys(Keys.RETURN)
        print(f"Logged in successfully to FTP: {url}")
    except:
        print(f"No password required for FTP: {url}")

# Iterate through Excel data
for index, row in df.iterrows():
    action = row["A"].strip().lower() if pd.notna(row["A"]) else ""
    requirement = row["B"].strip().upper() if pd.notna(row["B"]) else "N"
    url = row["C"].strip() if pd.notna(row["C"]) else ""
    
    if action == "access ftp path" and requirement == "Y" and url:
        access_ftp(url)
        time.sleep(2)

print("FTP Access Automation Completed!")
