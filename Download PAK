$pwd = Read-Host -AsSecureString
$bstr = [System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($pwd)
$value = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto($bstr)

schtasks.exe /run /S "AWSDMJNVAW0001" /U "SA-ITS-APSOMINT-LAB" /P $value /tn "OMPDISPATCHER\OMP_JNJ_MD_OMEGA_LAB"
Start-Sleep -Seconds 10
schtasks.exe /run /S "AWSDMJNVAW0002" /U "SA-ITS-APSOMINT-LAB" /P $value /tn "OMPDISPATCHER\OMP_JNJ_MD_OMEGA_LAB_DSPAgent"
schtasks.exe /run /S "AWSDMJNVAW000D" /U "SA-ITS-APSOMINT-LAB" /P $value /tn "OMP Dispatcher\OMP_JNJ_MD_OMEGA_LAB_DSPAgent"
schtasks.exe /run /S "AWSDMJNVAW000E" /U "SA-ITS-APSOMINT-LAB" /P $value /tn "OMP Dispatcher\OMP_JNJ_MD_OMEGA_LAB_DSPAgent"
schtasks.exe /run /S "AWSDMJNVAW000H" /U "SA-ITS-APSOMINT-LAB" /P $value /tn "OMPDispatcher\OMP_JNJ_MD_OMEGA_LAB_DSPAgent"
schtasks.exe /run /S "AWSDMJNVAW000M" /U "SA-ITS-APSOMINT-LAB" /P $value /tn "OMPDispatcher\OMP_JNJ_MD_OMEGA_LAB_DSPAgent"


Start-Sleep -Seconds 30
  $url = "http://awsdmjnvaw0001:8095/OMPDispatcher?wsdl"
      $time = try{ 
      $request = $null 
       ## Request the URI, and measure how long the response took. 
      $result1 = Measure-Command { $request = Invoke-WebRequest -Uri $url } 
      $result1.TotalMilliseconds 
      }  
  
      catch 
      { 
       <# If the request generated an exception (i.e.: 500 server error or 404 not found), we can pull the status code from the 
       Exception.Response property #> 
       $request = $_.Exception.Response 
       $time = -1 
      }   
      $result = [Array]$result + [PSCustomObject] @{ 
      Time = Get-Date; 
      Uri = $url; 
      StatusCode = [int] $request.StatusCode; 
      StatusDescription = $request.StatusDescription; 
      ResponseLength = $request.RawContentLength; 
      TimeTaken =  $time;  
      } 
      $result
      Clear-Variable result
