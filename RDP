# ------------- CONFIGURATION -------------
$serverName = "AWSDMKINVAW001"                   # ğŸ” Remote machine name
$username   = "JND\\your_username"              # ğŸ” Your domain username
$password   = "your_password"                   # ğŸ” Your password
$rdpFilePath = "C:\PAK\RDPFiles\AWSDMKINVAW001.rdp"  # ğŸ” Path to your existing .rdp file
# ------------------------------------------

# âœ… Step 1: Store RDP credentials
Write-Host "`nğŸ” Storing credentials for $serverName..." -ForegroundColor Cyan
cmdkey /add:$serverName /user:$username /pass:$password
Write-Host "âœ… Credentials stored in Windows Credential Manager.`n" -ForegroundColor Green

# âœ… Step 2: Launch RDP
if (Test-Path $rdpFilePath) {
    Write-Host "ğŸ“ RDP file found: $rdpFilePath" -ForegroundColor Green
    Write-Host "ğŸš€ Launching RDP session with auto login..." -ForegroundColor Cyan
    Start-Process "mstsc.exe" -ArgumentList "`"$rdpFilePath`""
    Start-Sleep -Seconds 2
    Write-Host "`nâ³ Please wait while remote session connects..." -ForegroundColor Yellow
    Write-Host "ğŸ§­ Next step: Open Task Manager â†’ Sign off users" -ForegroundColor DarkGray
} else {
    Write-Host "âŒ ERROR: RDP file not found at $rdpFilePath" -ForegroundColor Red
}
