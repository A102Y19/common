from pywinauto import Desktop
import time

def wait_for_update_installer():
    print("Step 1: Waiting for 'Update Installer' popup...")
    while True:
        try:
            win = Desktop(backend="uia").window(title_re=".*Update Installer.*")
            if win.exists(timeout=2):
                print("✅ Found 'Update Installer' popup!")
                return
        except:
            pass
        time.sleep(5)

def wait_for_information_popup():
    print("Step 2: Checking every minute for 'Information' popup...")

    while True:
        try:
            info_win = Desktop(backend="uia").window(title_re=".*Information.*")
            if info_win.exists(timeout=2):
                print("✅ Found 'Information' popup!")

                # Print message inside popup
                try:
                    text_elem = info_win.child_window(control_type="Text")
                    print("Popup Message:", text_elem.window_text())
                except:
                    print("⚠ Couldn't read text.")

                # Click OK button
                try:
                    ok_btn = info_win.child_window(title="OK", control_type="Button")
                    ok_btn.click()
                    print("✅ Clicked OK button.")
                except:
                    print("⚠ Couldn't click OK button.")

                break  # Exit after handling Information popup

        except Exception as e:
            print("⚠ Error while checking popup:", e)

        time.sleep(60)  # Wait for 1 minute

def monitor_popups():
    wait_for_update_installer()
    wait_for_information_popup()

if __name__ == "__main__":
    monitor_popups()
