from selenium.webdriver.common.action_chains import ActionChains
from selenium.webdriver.common.keys import Keys

def download_PAK_file(driver, file_name):
    try:
        print(f"üîç Searching for PAK file: {file_name}...")

        # Locate the file element based on span role and text
        file_xpath = f"//span[@role='listitem' and contains(text(), '{file_name}')]"
        file_element = WebDriverWait(driver, 20).until(
            EC.presence_of_element_located((By.XPATH, file_xpath))
        )

        print(f"‚úÖ File '{file_name}' found!")

        # Click on the file to activate the download option
        file_element.click()
        print("üìÇ File clicked!")

        # Wait for the 'Download' button to appear and click it
        download_button_xpath = "//button[contains(text(), 'Download')]"
        download_button = WebDriverWait(driver, 10).until(
            EC.element_to_be_clickable((By.XPATH, download_button_xpath))
        )
        download_button.click()
        print("üì• Download triggered successfully!")

        # Wait and verify if the file is downloaded
        time.sleep(5)  # Adjust sleep time as needed

        # Here, you can check the default download folder if required
        print("‚úÖ Download verification complete!")

    except Exception as e:
        print(f"‚ùå ERROR: Could not download file '{file_name}'. Details: {e}")
