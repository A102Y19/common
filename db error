from pywinauto import Desktop
import time

def read_information_popup_text():
    print("üîç Searching for Information popup using win32 backend...")

    desktop = Desktop(backend="win32")
    popup = None

    while not popup:
        for win in desktop.windows():
            if "Information" in win.window_text():
                popup = win
                print(f"‚úÖ Found popup: {popup.window_text()}")
                break
        time.sleep(2)

    # Try to extract meaningful text
    print("üìÑ Reading text from child controls:")
    found_msg = False
    for i, ctrl in enumerate(popup.children()):
        try:
            text = ctrl.window_text().strip()
            if text:
                print(f"{i+1:02}: '{text}'")
                # Check if it's a known message
                if "error" in text.lower():
                    print("‚ùå Detected an error message.")
                    found_msg = True
                elif "success" in text.lower():
                    print("‚úÖ Detected a success message.")
                    found_msg = True
        except Exception as e:
            print(f"{i+1:02}: Error reading text: {e}")
    
    if not found_msg:
        print("‚ö†Ô∏è Could not confidently determine success or error from the popup.")

