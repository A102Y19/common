from pywinauto import Desktop
import time

def read_information_popup_win32():
    print("üîç Trying with win32 backend to read Information popup...")

    app = Desktop(backend="win32")
    info_win = None

    while not info_win:
        for w in app.windows():
            if "Information" in w.window_text():
                info_win = w
                print(f"‚úÖ Found popup: {info_win.window_text()}")
                break
        time.sleep(2)

    # Now read all child controls using win32
    print("üì¶ Dumping child texts...")
    try:
        for i, ctrl in enumerate(info_win.children()):
            try:
                print(f"{i+1:03}: {ctrl.window_text()}")
            except Exception as e:
                print(f"{i+1:03}: Error reading text: {e}")
    except Exception as e:
        print(f"‚ùå Failed to dump win32 controls: {e}")
