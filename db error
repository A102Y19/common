function refreshToken {
    param (
        [string]$userId,
        [string]$refreshToken
    )

    $headers = @{
        "Accept"       = "application/json"
        "Content-Type" = "application/json"
    }

    $body = @{
        userId       = $userId
        refreshToken = $refreshToken
    } | ConvertTo-Json -Depth 2

    try {
        $response = Invoke-RestMethod -Uri $script:riseAuthRefreshUrl -Method Post -Headers $headers -Body $body
        return $response.accessToken
    } catch {
        Write-Error "refreshToken : Failed to refresh token: $($_.Exception.Message)"
        return $null
    }
}
