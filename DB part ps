# Ensure the remote machine has PowerShell remoting enabled:
Enable-PSRemoting -Force

# Define your server, username, and password
$server = "RemoteServerName"
$username = "YourUsername"
$password = "YourPassword"

# Create a credential object for authentication
$cred = New-Object System.Management.Automation.PSCredential($username, ($password | ConvertTo-SecureString -AsPlainText -Force))

# Use Invoke-Command to run commands on the remote machine without opening RDP
Invoke-Command -ComputerName $server -Credential $cred -ScriptBlock {
    # Commands to execute on the remote machine
    pushd C:\Your\Target\Path
    .\DispatcherManagementAction.cmd stop /all
}
